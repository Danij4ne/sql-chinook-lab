

-- PROJECT 100 - ADVANCED ANALYTICS CHALLENGE
-- Difficulty: HARD
-- Database: Chinook

-- DESCRIPTION:
-- Build an end-to-end SQL analytical pipeline using everything learned.

-- REQUIREMENTS:
--   Include:
--     - Multiple CTEs
--     - At least one recursive CTE
--     - Subqueries (scalar, correlated, IN/NOT IN)
--     - Window functions (rank, lag, running totals)
--     - Aggregations
--     - Joins (including multi-table joins)

-- INSIGHTS TO PRODUCE:
--   1. Top customers by lifetime value
--   2. Customer retention stages
--   3. Top-performing genres and artists
--   4. Revenue trends over time
--   5. Country purchase behavior patterns
--   6. A final master table combining all KPIs
